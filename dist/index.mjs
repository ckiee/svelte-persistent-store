var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},t=function(){return t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.apply(this,arguments)};function n(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var r=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}(n,t),n}(Error),o={},i=new Set,a={};function c(e,n){if("string"==typeof e||"number"==typeof e&&!isNaN(e)&&Math.abs(e)!==1/0||null==e||"boolean"==typeof e)return e;var r=n.indexOf(e);if(-1!==r)return"#$@__instance__"+r;n.push(e);var o=n.length-1;if(e.constructor===Array){var s=e.map((function(e){return c(e,n)}));return s.unshift("#$@__reference__"+o),s}if(e.constructor===Object){var u=Object.fromEntries(Object.entries(e).map((function(e){return[e[0],c(e[1],n)]})));return u["#$@__reference__"]=o,u}i.add(e.constructor);var l={};l=Object.defineProperty(l,"#$@__constructor__",{value:e.constructor.name,enumerable:!0}),l=Object.defineProperty(l,"#$@__reference__",{value:o,enumerable:!0});var f=function(e,t){if(Object.keys(a).includes(e.constructor.name))return a[e.constructor.name].toPlain(e,(function(e){return c(e,t)}))}(e,n);return void 0!==f?t(t({},f),l):(Object.getOwnPropertyNames(e).forEach((function(t){Object.defineProperty(l,t,{value:c(e[t],n),enumerable:!0})})),l)}function s(e,t,n){var o;if("string"==typeof e&&0===e.indexOf("#$@__instance__"))return n[l=parseInt(e.slice(15))];if("string"==typeof e||"number"==typeof e||null==e||"boolean"==typeof e)return e;if(e.constructor===Array){if(0===e.length)return[];var i=e.shift();if("string"!=typeof i||"#$@__reference__"!==i.substring(0,16)){if(0===Object.keys(n).length)return e.unshift(i),e;throw new r}var c=[];n[l=i.slice(16)]=c;for(var u=0;u<e.length;u++)c[u]=s(e[u],t,n);return c}if(e.constructor===Object){var l;if(null===(l=null!==(o=e["#$@__reference__"])&&void 0!==o?o:null)){if(0===Object.keys(n).length)return e;throw new r}if(delete e["#$@__reference__"],!Object.keys(e).includes("#$@__constructor__")){for(var f in c={},n[l]=c,e)c[f]=s(e[f],t,n);return c}var d=e["#$@__constructor__"];delete e["#$@__constructor__"];var p=function(e,t,n,r){if(Object.keys(a).includes(t))return a[t].fromPlain(e,(function(e){return s(e,n,r)}))}(e,d,t,n);if(void 0!==p)return p;if(!Object.keys(t).includes(d))throw new Error("The class "+d+" is not allowed");var y={};for(var f in n[l]=y,e)y[f]=s(e[f],t,n);return Object.setPrototypeOf(y,t[d].prototype),y}}function u(e){o[e.name]=e}!function(e,t){e("Date",(e=>({time:e.getTime()})),(function(e){let t=new Date;return t.setTime(e.time),t})),e("BigInt",(e=>({number:e.toString()})),(e=>BigInt(e.number))),e("String",(e=>({text:e.toString()})),(e=>new String(e.text))),e("RegExp",(e=>({source:e.source,flags:e.flags})),(e=>new RegExp(e.source,e.flags))),e("Number",(function(e){let t={nan:!1,infinity:!1,positive:!0,number:null};return Math.abs(e)===1/0?(t.infinity=!0,t.positive=Math.abs(e)===e,t):isNaN(e)?(t.nan=!0,t):(t.number=e.valueOf(),t)}),(function(e){return e.nan?NaN:e.infinity?1/0*(e.positive?1:-1):new Number(e.number)})),e("Map",((e,t)=>({data:Array.from(e.entries()).map((e=>t(e)))})),(function(e,t){const n=new Map;return e.data.map((e=>t(e))).forEach((([e,t])=>n.set(e,t))),n})),e("Set",((e,t)=>({data:Array.from(e.values()).map((e=>t(e)))})),(function(e,t){const n=new Set;return e.data.map((e=>t(e))).forEach((e=>n.add(e))),n})),e("ArrayBuffer",((e,t)=>({data:t(new Uint8Array(e))})),((e,t)=>t(e.data).buffer)),e("DataView",((e,t)=>({buffer:t(e.buffer),offset:e.byteOffset,length:e.byteLength})),((e,t)=>new DataView(t(e.buffer),e.offset,e.length))),[Error,EvalError,RangeError,AggregateError,ReferenceError,SyntaxError,TypeError,URIError,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array].forEach((e=>t(e)))}((function(e,t,n){a[e]={toPlain:t,fromPlain:n}}),u);var l,f={};function d(e){return new Promise(((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)}))}function p(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const r=d(n);return(e,n)=>r.then((r=>n(r.transaction(t,e).objectStore(t))))}let y;function g(){return y||(y=p("keyval-store","keyval")),y}function m(e){let t,n=e[0],r=1;for(;r<e.length;){const o=e[r],i=e[r+1];if(r+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=i(n)):"call"!==o&&"optionalCall"!==o||(n=i(((...e)=>n.call(t,...e))),t=void 0)}return n}function v(){h=!0}(l=f).defaults={},l.set=function(e,t,n){var r=n||{},o=l.defaults,i=r.expires||o.expires,a=r.domain||o.domain,c=void 0!==r.path?r.path:void 0!==o.path?o.path:"/",s=void 0!==r.secure?r.secure:o.secure,u=void 0!==r.httponly?r.httponly:o.httponly,f=void 0!==r.samesite?r.samesite:o.samesite,d=i?new Date("number"==typeof i?(new Date).getTime()+864e5*i:i):0;document.cookie=e.replace(/[^+#$&^`|]/g,encodeURIComponent).replace("(","%28").replace(")","%29")+"="+t.replace(/[^+#$&/:<-\[\]-}]/g,encodeURIComponent)+(d&&d.getTime()>=0?";expires="+d.toUTCString():"")+(a?";domain="+a:"")+(c?";path="+c:"")+(s?";secure":"")+(u?";httponly":"")+(f?";samesite="+f:"")},l.get=function(e){for(var t=document.cookie.split(";");t.length;){var n=t.pop(),r=n.indexOf("=");if(r=r<0?n.length:r,decodeURIComponent(n.slice(0,r).replace(/^\s+/,""))===e)return decodeURIComponent(n.slice(r+1))}return null},l.erase=function(e,t){l.set(e,"",{expires:-1,domain:t&&t.domain,path:t&&t.path,secure:0,httponly:0})},l.all=function(){for(var e={},t=document.cookie.split(";");t.length;){var n=t.pop(),r=n.indexOf("=");r=r<0?n.length:r,e[decodeURIComponent(n.slice(0,r).replace(/^\s+/,""))]=decodeURIComponent(n.slice(r+1))}return e};let h=!1;const b=[],w=e=>{(e=>{const t="undefined"!=typeof process&&"production"===m([process,"access",e=>e.env,"optionalAccess",e=>e.NODE_ENV]);h||b.includes(e)||t||("undefined"==typeof window&&(e+="\nAre you running on a server? Most of storages are not available while running on a server."),console.warn(e),b.push(e))})(`Unable to find the ${e}. No data will be persisted.`)};function _(e){S(e)}let O=function(e){return void 0===e?"undefined":JSON.stringify(c(e,[]))},L=function(e,t){if(void 0===t&&(t=void 0),"string"!=typeof e)return e;if(void 0===t&&(t={}),"undefined"!==e){t=Object.fromEntries(n(n([],Object.entries(t),!0),Object.entries(o),!0));try{return s(JSON.parse(e),t,{})}catch(t){return e}}},S=u;function A(e,t,n){var r,o;O=e,L=t,o=()=>()=>{},S=null!=(r=n)?r:o()}function j(e,t,n){const r=t.getValue(n);return null!==r&&e.set(r),t.addListener&&t.addListener(n,(t=>{e.set(t)})),e.subscribe((e=>{t.setValue(n,e)})),{...e,delete(){t.deleteValue(n)}}}function E(){}function k(e=E,t=E){const n=[];return{callListeners(e,t){void 0!==t&&n.filter((({key:t})=>t===e)).forEach((({listener:e})=>e(t)))},addListener(t,r){n.push({key:t,listener:r}),1===n.length&&e()},removeListener(e,r){const o=n.indexOf({key:e,listener:r});-1!==o&&n.splice(o,1),0===n.length&&t()}}}function V(e,t=!1){const n=t=>{const n=t.key;t.storageArea===e&&o(n,L(t.newValue))},{removeListener:r,callListeners:o,addListener:i}=k((()=>{t&&"undefined"!=typeof window&&m([window,"optionalAccess",e=>e.addEventListener])&&window.addEventListener("storage",n)}),(()=>{t&&"undefined"!=typeof window&&m([window,"optionalAccess",e=>e.removeEventListener])&&window.removeEventListener("storage",n)}));return{addListener:i,removeListener:r,getValue(t){const n=e.getItem(t);return L(n)},deleteValue(t){e.removeItem(t)},setValue(t,n){e.setItem(t,O(n))}}}function C(e){try{return"object"==typeof window[e]}catch(e){return!1}}function I(e=!1){return C("localStorage")?V(window.localStorage,e):(w("window.localStorage"),D())}function x(e=!1){return C("sessionStorage")?V(window.sessionStorage,e):(w("window.sessionStorage"),D())}function N(e){return"undefined"==typeof document||"string"!=typeof m([document,"optionalAccess",e=>e.cookie])?(w("document.cookies"),D()):{getValue(e){const t=f.get(e);return L(t)},deleteValue(t){f.erase(t,{samesite:"Strict",...e})},setValue(t,n){f.set(t,O(n),{samesite:"Strict",...e})}}}function U(){if("object"!=typeof indexedDB||!C("indexedDB"))return w("IndexedDB"),R();const{removeListener:e,callListeners:t,addListener:n}=k(),r=p("svelte-persist","persist");return{addListener:n,removeListener:e,getValue:e=>(function(e,t=g()){return t("readonly",(t=>d(t.get(e))))}(e,r).then((n=>t(e,L(n)))),null),setValue(e,t){!function(e,t,n=g()){n("readwrite",(n=>(n.put(t,e),d(n.transaction))))}(e,O(t),r)},deleteValue(e){!function(e,t=g()){t("readwrite",(t=>(t.delete(e),d(t.transaction))))}(e,r)}}}var $;function P(e=$.LOCAL,t=!1){if("object"!=typeof chrome||"object"!=typeof chrome.storage)return w("ChromeStorage"),R();let n="local";switch(e){case $.LOCAL:n="local";break;case $.SYNC:n="sync";break;case $.SESSION:n="session"}function r(e,t){if(t===n)for(const[t,{newValue:n}]of Object.entries(e))i(t,n)}const{removeListener:o,callListeners:i,addListener:a}=k((()=>{t&&chrome.storage.onChanged.addListener(r)}),(()=>{t&&chrome.storage.onChanged.removeListener(r)}));return{addListener:a,removeListener:o,getValue:e=>(chrome.storage[n].get([e],(t=>i(e,t.key))),null),setValue(e,t){chrome.storage[n].set({[e]:t})},deleteValue(e){chrome.storage[n].remove(e)}}}function D(){return{getValue:()=>null,deleteValue(){},setValue(){}}}function R(){return{...D(),addListener(){},removeListener(){}}}function B(){}!function(e){e[e.LOCAL=0]="LOCAL";e[e.SESSION=1]="SESSION";e[e.SYNC=2]="SYNC"}($||($={}));const T=[];function M(e,t=B){let n;const r=new Set;function o(t){if(function(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}(e,t)&&(e=t,n)){const t=!T.length;for(const t of r)t[1](),T.push(t,e);if(t){for(let e=0;e<T.length;e+=2)T[e][0](T[e+1]);T.length=0}}}function i(t){o(t(e))}return{set:o,update:i,subscribe:function(a,c=B){const s=[a,c];return r.add(s),1===r.size&&(n=t(o,i)||B),a(e),()=>{r.delete(s),0===r.size&&n&&(n(),n=null)}}}}const Y={};function z(e){if(!Object.keys(Y).includes(e))switch(e){case"cookie":Y[e]=N();break;case"local":Y[e]=I();break;case"session":Y[e]=x()}return Y[e]}function F(e,t){return j(e,z("cookie"),t)}function J(e,t){return j(e,z("session"),t)}function q(e,t){return j(e,z("local"),t)}function G(e,t,n){return q(M(t,n),e)}function H(e,t,n){return G(e,t,n)}function K(e,t,n){return J(M(t,n),e)}function Q(e,t,n){return F(M(t,n),e)}export{_ as addSerializableClass,Q as cookieWritable,P as createChromeStorage,N as createCookieStorage,U as createIndexedDBStorage,I as createLocalStorage,D as createNoopStorage,x as createSessionStorage,v as disableWarnings,G as localWritable,j as persist,q as persistBrowserLocal,J as persistBrowserSession,F as persistCookie,K as sessionWritable,A as setSerialization,H as writable};
